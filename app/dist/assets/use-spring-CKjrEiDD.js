import{n as E,o as S,p as g,J as F,u as y,r as l,M as C,q as w,t as I,v as J,w as p}from"./index-DDIaC_da.js";function L(...t){const e=!Array.isArray(t[0]),n=e?0:-1,o=t[0+n],s=t[1+n],c=t[2+n],r=t[3+n],a=E(s,c,r);return e?a(o):a}function M(t,e,n={}){const o=t.get();let s=null,c=o,r;const a=typeof o=="string"?o.replace(/[\d.-]/g,""):void 0,i=()=>{s&&(s.stop(),s=null)},m=()=>{i();const u=V(t.get()),f=V(c);u!==f&&(s=new F({keyframes:[u,f],velocity:t.getVelocity(),type:"spring",restDelta:.001,restSpeed:.01,...n,onUpdate:r}))};if(t.attach((u,f)=>{c=u,r=d=>f(A(d,a)),S.postRender(()=>{m(),t.events.animationStart?.notify(),s?.then(()=>{t.events.animationComplete?.notify()})})},i),g(e)){const u=e.on("change",d=>t.set(A(d,a))),f=t.on("destroy",u);return()=>{u(),f()}}return i}function A(t,e){return e?t+e:t}function V(t){return typeof t=="number"?t:parseFloat(t)}function b(t){const e=y(()=>w(t)),{isStatic:n}=l.useContext(C);if(n){const[,o]=l.useState(t);l.useEffect(()=>e.on("change",o),[])}return e}function k(t,e){const n=b(e()),o=()=>n.set(e());return o(),I(()=>{const s=()=>S.preRender(o,!1,!0),c=t.map(r=>r.on("change",s));return()=>{c.forEach(r=>r()),J(o)}}),n}function D(t){p.current=[],t();const e=k(p.current,t);return p.current=void 0,e}function x(t,e,n,o){if(typeof t=="function")return D(t);if(n!==void 0&&!Array.isArray(n)&&typeof e!="function")return N(t,e,n,o);const r=typeof e=="function"?e:L(e,n,o),a=Array.isArray(t)?h(t,r):h([t],([m])=>r(m)),i=Array.isArray(t)?void 0:t.accelerate;return i&&!i.isTransformed&&typeof e!="function"&&Array.isArray(n)&&o?.clamp!==!1&&(a.accelerate={...i,times:e,keyframes:n,isTransformed:!0}),a}function h(t,e){const n=y(()=>[]);return k(t,()=>{n.length=0;const o=t.length;for(let s=0;s<o;s++)n[s]=t[s].get();return e(n)})}function N(t,e,n,o){const s=y(()=>Object.keys(n)),c=y(()=>({}));for(const r of s)c[r]=x(t,e,n[r],o);return c}function U(t,e={}){const{isStatic:n}=l.useContext(C),o=()=>g(t)?t.get():t;if(n)return x(o);const s=b(o());return l.useInsertionEffect(()=>M(s,t,e),[s,JSON.stringify(e)]),s}function q(t,e={}){return U(t,{type:"spring",...e})}export{x as a,b,q as u};
